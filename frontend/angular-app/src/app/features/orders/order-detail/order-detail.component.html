<div class="order-detail-container">
    <!-- Navigation Header -->
    <div class="navigation-header">
        <div class="nav-content">
            <button (click)="back()" class="back-btn">
                <svg class="back-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
            </button>
            <nav class="breadcrumb">
                <a routerLink="/orders" class="breadcrumb-link">Orders</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Order Details</span>
            </nav>
        </div>
    </div>

    <!-- Order Detail Card -->
    <div class="order-card" *ngIf="order">
        <!-- Order Header -->
        <div class="order-header">
            <div class="order-title-section">
                <h1 class="order-title">Order Details</h1>
                <div class="order-id">#{{ order.id }}</div>
            </div>
            <div class="status-section">
                <span class="status-badge" [class.status-new]="order.status === 'New'"
                    [class.status-pending]="order.status === 'Pending'"
                    [class.status-completed]="order.status === 'Completed'"
                    [class.status-cancelled]="order.status === 'Cancelled'">
                    {{ order.status }}
                </span>
            </div>
        </div>

        <!-- Order Information -->
        <div class="order-info">
            <div class="info-grid">
                <div class="info-item">
                    <label class="info-label">Customer</label>
                    <div class="info-value">{{ order.customerName }}</div>
                </div>
                <div class="info-item">
                    <label class="info-label">Created At</label>
                    <div class="info-value">{{ order.createdAt | localDate:'medium' }}</div>
                </div>
                <div class="info-item">
                    <label class="info-label">Status Management</label>
                    <div class="status-controls">
                        <select [(ngModel)]="order._newStatus" class="status-select">
                            <option [ngValue]="undefined" disabled>Change status...</option>
                            <option value="Pending">Pending</option>
                            <option value="Completed">Completed</option>
                            <option value="Cancelled">Cancelled</option>
                        </select>
                        <button *ngIf="order._newStatus && order._newStatus !== order.status" (click)="updateStatus()"
                            class="update-btn">
                            Update Status
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Order Lines Section -->
        <div class="lines-section">
            <div class="section-header">
                <h2 class="section-title">Order Items</h2>
                <div class="items-count" *ngIf="order.lines && order.lines.length > 0">
                    {{ order.lines.length }} item{{ order.lines.length !== 1 ? 's' : '' }}
                </div>
            </div>

            <div class="lines-content" *ngIf="order.lines && order.lines.length > 0">
                <div class="lines-table">
                    <div class="table-header">
                        <div class="header-product">Product</div>
                        <div class="header-quantity">Quantity</div>
                        <div class="header-price">Price</div>
                    </div>
                    <div class="table-body">
                        <div class="table-row" *ngFor="let line of order.lines">
                            <div class="cell-product">
                                <div class="product-name">{{ line.product }}</div>
                            </div>
                            <div class="cell-quantity">
                                <span class="quantity-badge">{{ line.quantity }}</span>
                            </div>
                            <div class="cell-price">
                                <span class="price-amount">{{ line.amount }}</span>
                                <span class="price-currency">{{ line.currency }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <div class="summary-row">
                        <span class="summary-label">Total Items:</span>
                        <span class="summary-value">{{ getTotalQuantity() }}</span>
                    </div>
                    <div class="summary-row total-row">
                        <span class="summary-label">Total Amount:</span>
                        <span class="summary-value">{{ getTotalAmount() | currency:'USD':'symbol':'1.2-2' }}</span>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div class="empty-state" *ngIf="!order.lines || order.lines.length === 0">
                <div class="empty-icon">ðŸ“¦</div>
                <div class="empty-title">No items found</div>
                <div class="empty-description">This order doesn't have any items yet.</div>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="loading">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">Loading order details...</div>
        </div>
    </div>
</div>